# ESP32 Ready4Sky (R4S) —à–ª—é–∑ –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ Redmond+
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft2.gif)

&emsp; –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è 2021.03.08. –í—Ä–æ–¥–µ –±—ã –Ω–∞—à–µ–ª –≤ –∫–æ–¥–µ –ø—Ä–∏—á–∏–Ω—É –∑–∞–≤–∏—Å–∞–Ω–∏—è BLE –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏. –ù–æ –ø–æ–∫–∞ —Å–∏–ª—å–Ω–æ –Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–ø—Ü–∏—è "BLE monitoring". –ï—Å–ª–∏ –æ–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ—à–∏–≤–∫–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏, —Ç–æ –µ—Å—Ç—å —Ä–µ—Å—Ç–∞—Ä—Ç –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –±–æ–ª–µ–µ 2-—Ö –º–∏–Ω—É—Ç –∏ –æ—à–∏–±–∫–µ —Å–∫–∞–Ω–∞. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏–≤–∞—Ä–∫–∏ RMC-M903S –∏ —á–∞—Å—Ç–∏—á–Ω–æ –¥—É—Ö–æ–≤–æ–≥–æ —à–∫–∞—Ñ–∞ RO-5707S, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ä–µ–∂–∏–º–æ–≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏ –∞–≤—Ç–æ–ø–æ–¥–æ–≥—Ä–µ–≤–∞. 
–í RMC-M800S –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º—É–ª—å—Ç–∏–ø–æ–≤–∞—Ä. –í —Ä–µ–∂–∏–º–µ RMC-M903S –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏ –¥—Ä—É–≥–∏–µ –º—É–ª—å—Ç–∏–≤–∞—Ä–∫–∏. –û—Ç–∫–ª—é—á–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è BLE  —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤–æ –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. –ù–∞ —ç–∫—Ä–∞–Ω–µ –≤–º–µ—Å—Ç–æ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –∏ —Ç–æ–∫ –∏–∑ [ZMAi-90](https://github.com/alutov/zmai-90_mqtt_gateway).<br>

### ENG<br>
[Use Google to translate into English.](https://translate.google.com/translate?hl=ru&sl=ru&tl=en&u=https%3A%2F%2Fgithub.com%2Falutov%2FESP32-R4sGate-for-Redmond%2Fblob%2Fmaster%2FREADME.md)<br>
### RUS<br>
&emsp; ESP32 r4sGate –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å BLE-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ Redmond –∏ —á–∞–π–Ω–∏–∫–∏ Xiaomi MiKettle –∫ —Å–∏—Å—Ç–µ–º–µ "—É–º–Ω—ã–π –¥–æ–º" –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É MQTT. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è 3 BLE —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Xiaomi MiKettle –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∏–∑ —Ä–µ–∂–∏–º–∞ "keep warm". –í —ç—Ç–æ–º —Ä–µ–∂–∏–º–µ —á–∞–π–Ω–∏–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–¥–∞–Ω–Ω—É—é —à–ª—é–∑–æ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É 40&deg;C —Å –≥–∏—Å—Ç–µ—Ä–µ–∑–∏—Å–æ–º –ø—Ä–∏–º–µ—Ä–Ω–æ 4&deg;C, —Ç–æ –µ—Å—Ç—å –ø—Ä–∏ 36&deg;C –ø–æ–¥–æ–≥—Ä–µ–≤ –≤–∫–ª—é—á–∞–µ—Ç—Å—è, –∞ –ø—Ä–∏ 44&deg;C –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è. –î–æ—Å—Ç—É–ø–Ω–æ –≤–∫–ª—é—á–µ–Ω–∏–µ –∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∫–∏–ø—è—á–µ–Ω–∏—è (state = ON/OFF), —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ–¥–æ–≥—Ä–µ–≤–∞ (heat_temp = 40...95). –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ —á–∞–π–Ω–∏–∫ –≤ —Ä–µ–∂–∏–º Idle (heat_temp = 0). –ü–æ—Å–ª–µ–¥–Ω—è—è –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π. –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã –¥–∞–ª—å–Ω–µ–π—à–µ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞–π–Ω–∏–∫–æ–º –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –≤—ã–∫–ª—é—á–µ–Ω–∏—è —Å–µ–Ω—Å–æ—Ä–æ–º "warm" –Ω–∞ —á–∞–π–Ω–∏–∫–µ –ø—Ä–∏ –¥–∞–ª—å–Ω–µ–π—à–µ–º –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —á–∞–π–Ω–∏–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ä–µ–∂–∏–º "keep warm". –í–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ MCU 6.2.1.9. –ü–æ–∫–∞ –æ—Å—Ç–∞–≤–∏–ª —Ç–∞–∫ –∏ –≤–∫–ª—é—á–∏–ª —á–∞–π–Ω–∏–∫ —á–µ—Ä–µ–∑ —Ä–µ–¥–º–æ–Ω–¥–æ–≤—Å–∫—É—é —Ä–æ–∑–µ—Ç–∫—É. –ï—Å–ª–∏ –µ–µ –≤—ã–∫–ª—é—á–∏—Ç—å –∏ –æ–ø—è—Ç—å –≤–∫–ª—é—á–∏—Ç—å, —á–∞–π–Ω–∏–∫ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∂–∏–º –ø–æ–¥–æ–≥—Ä–µ–≤–∞. –û—Å—Ç–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ—Å—Ç–∞—Ä—Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ QN9020 —á–∞–π–Ω–∏–∫–∞ –ø–æ BLE –∏ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ. üòâ –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–∞–π–Ω–∏–∫–∞ —à–ª—é–∑ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –∞ —Ä–æ–¥–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—à–∏–≤–∫–∏. –í—Ä–µ–º—è –ø–æ–¥–æ–≥—Ä–µ–≤–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ 12 —á–∞—Å–æ–≤ (720 –º–∏–Ω—É—Ç), –ø–æ—Å–ª–µ 700 –º–∏–Ω—É—Ç —à–ª—é–∑ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤–∫–ª—é—á–∞—è –∏ –≤—ã–∫–ª—é—á–∞—è –∫–∏–ø—è—á–µ–Ω–∏–µ.<br>
[–°–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏:](https://github.com/alutov/ESP32-R4sGate-for-Redmond/issues/12)<br>
**–≠–ª–µ–∫—Ç—Ä–æ—á–∞–π–Ω–∏–∫**<br>
Redmond SkyKettle M171S<br>
Redmond SkyKettle M173S<br>
Redmond SkyKettle G200S<br>
Redmond SkyKettle G210S<br>
Redmond SkyKettle G211S<br>
Redmond SkyKettle G212S<br>
Redmond SkyKettle G216S<br>
Redmond SkyKettle G240S<br>
Xiaomi MiKettle YM-K1501(Int) - ProductId 275<br>
Xiaomi MiKettle YM-K1501(HK) - ProductId 131<br>
Xiaomi MiKettle V-SK152(Int) - ProductId 1116<br>

**–ú—É–ª—å—Ç–∏–≤–∞—Ä–∫–∞**<br>
Redmond SkyCooker RMC-M800S<br>
Redmond SkyCooker RMC-M903S<br>
**–ö–æ—Ñ–µ–≤–∞—Ä–∫–∞**<br>
Redmond SkyCoffee M1519S<br>
**–†–æ–∑–µ—Ç–∫–∞**<br>
Redmond SkyPort 103S<br>
**–ö–æ–Ω–≤–µ–∫—Ç–æ—Ä —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π**<br>
Redmond SkyHeat 4529S<br><br>
&emsp; –î–∞–≤–Ω–æ —É–∂–µ –µ—Å—Ç—å –æ—Ç–ª–∏—á–Ω—ã–π –ø–æ–¥–æ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è esp32 –Ω–∞ [–ì–∏—Ç—Ö–∞–±–µ](https://github.com/olehs/r4sGate) ([—Ñ–æ—Ä—É–º —Ç—É—Ç](https://mjdm.ru/forum/viewtopic.php?f=8&t=5501)), –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π olehs –¥–ª—è —Å—Ä–µ–¥—ã –∞—Ä–¥—É–∏–Ω–æ. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –≤ –∞—Ä–¥—É–∏–Ω–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ BLE –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Ç–µ—Ä—è–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º. –í–æ—Ç –ø–æ—á–µ–º—É –ø–µ—Ä–µ–ø–∏—Å–∞–ª –ø—Ä–æ–≥—Ä–∞–º–º—É –∑–∞–Ω–æ–≤–æ, –Ω–æ —É–∂–µ –≤ espressif esp-idf —Å—Ä–µ–¥–µ. –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å —Ç–µ–º–∏ –∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ (27.08.2020), –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è —Ç–æ–ª—å–∫–æ —á–∞–π–Ω–∏–∫ –∏ –æ–¥–Ω–æ BLE —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, —Ä–∞–±–æ—Ç–∞–µ—Ç —à—É—Å—Ç—Ä–µ–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –¥–µ—Ä–∂–∏—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —á–∞–π–Ω–∏–∫–æ–º, –∞ —Å–≤–æ–±–æ–¥–Ω–æ–π –ø–∞–º—è—Ç–∏ —Å—Ç–∞–ª–æ –±–æ–ª—å—à–µ. –ù–∞–¥–µ—é—Å—å, —á—Ç–æ –∏ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ —Ö—É–∂–µ.<br>
&emsp; –î–ª—è –∑–∞–ø—É—Å–∫–∞ —à–ª—é–∑–∞ –Ω—É–∂–Ω–æ –∑–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å ESP32. –§–∞–π–ª fr4sGate.bin –≤ –ø–∞–ø–∫–µ build —ç—Ç–æ —É–∂–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫ –¥–ª—è esp32 @160MHz —Å –ø–∞–º—è—Ç—å—é 4 –ú–±–∞–π—Ç –∏ –ø—Ä–æ—à–∏–≤–∞–µ—Ç—Å—è –æ–¥–Ω–∏–º —Ñ–∞–π–ª–æ–º —Å –∞–¥—Ä–µ—Å–∞ 0x0000 –Ω–∞ —á–∏—Å—Ç—É—é esp32. –í–º–µ—Å—Ç–æ –Ω–µ–≥–æ —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ñ–∞–π–ª–∞ –¥–ª—è –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏: bootloader.bin (–∞–¥—Ä–µ—Å 0x1000),  partitions.bin (–∞–¥—Ä–µ—Å 0x8000) –∏ r4sGate.bin (–∞–¥—Ä–µ—Å 0x10000). –§–∞–π–ª r4sGate.bin –º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—à–∏–≤–∫–∏ —á–µ—Ä–µ–∑ web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.<br>
&emsp; –ó–∞—Ç–µ–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –≥–æ—Å—Ç–µ–≤—É—é —Å–µ—Ç—å Wi-Fi –≤ —Ä–æ—É—Ç–µ—Ä–µ —Å ssid "r4s" –∏ –ø–∞—Ä–æ–ª–µ–º "12345678", –ø–æ–¥–æ–∂–¥–∞—Ç—å, –ø–æ–∫–∞ esp32 –Ω–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ –Ω–µ–º—É, –≤–≤–µ—Å—Ç–∏ esp32 IP-–∞–¥—Ä–µ—Å –≤ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä–µ –∏ –≤–æ –≤–∫–ª–∞–¥–∫–µ Setting —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –ü–æ—Å–ª–µ —á–µ–≥–æ –≥–æ—Å—Ç–µ–≤–∞—è —Å–µ—Ç—å –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–∞. Esp32 –±—É–¥–µ—Ç –ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ç–∏ "r4s" —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–∞—Ä–æ–ª–µ. –ï—Å–ª–∏ –Ω–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∏ –∫ –≥–æ—Å—Ç–µ–≤–æ–π —Å–µ—Ç–∏, esp32 –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è. –í–∞—Ä–∏–∞–Ω—Ç —Å –≥–æ—Å—Ç–µ–≤–æ–π —Å–µ—Ç—å—é –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—â–µ–ø—Ä–∏–Ω—è—Ç–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏ –∑–∞–ø—É—Å–∫–∞ —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ esp32, –∫–∞–∫ –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è, —É–¥–æ–±–Ω–µ–µ, —Ç–∞–∫ –∫–∞–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤—Å–µ —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –Ω–µ —Ç—ã–∫–∞—è –ø–∞–ª—å—Ü–∞–º–∏ –≤ —Å–º–∞—Ä—Ç—Ñ–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–Ω–µ—Ç–∞ —Ç–∞–∫ –∏ –Ω–æ—Ä–æ–≤–∏—Ç —Å–æ—Å–∫–æ—á–∏—Ç—å —Å esp32. –ù–æ, –≥–ª–∞–≤–Ω–æ–µ, –≤ —Å–ª—É—á–∞–µ –ø–∞–¥–µ–Ω–∏—è –ø–æ –∫–∞–∫–∏–º-—Ç–æ –ø—Ä–∏—á–∏–Ω–∞–º Wi-Fi —Ä–æ—É—Ç–µ—Ä–∞ (–∞ –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–º —Ç–æ–ª—å–∫–æ –¥–ª—è iot —É—Å—Ç—Ä–æ–π—Å—Ç–≤) –æ—Å—Ç–∞–ª—å–Ω–æ–π Wi-Fi –Ω–µ –∑–∞—Å–æ—Ä—è–µ—Ç—Å—è –¥—Ä—É–∂–Ω–æ "–≤–ø–ª—ã–≤—à–∏–º–∏" esp32.<br>
&emsp; –î–∞–ª–µ–µ –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –∏–º—è Redmond —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –ø—Ä–∏–≤—è–∑–∞—Ç—å –µ–≥–æ –∫ —à–ª—é–∑—É. –ü–æ–∏—Å–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ, –Ω–æ –Ω–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ. –ï—Å–ª–∏ –∏–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–æ—á–Ω–æ –Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ, —Ç–æ –µ—Å—Ç—å –¥–ª—è –Ω–∞—á–∞–ª–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –≤ –ø–æ–ª–µ "Name" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ª—é–±–æ–µ –∏–º—è, –∞ –ø–æ—Ç–æ–º –∑–∞–º–µ–Ω–∏—Ç—å –µ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω—ã–º (—Å—Ç—Ä–æ–∫–∞ "BLE last found device name") –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –≤—ã–±—Ä–∞—Ç—å –±–ª–∏–∂–∞–π—à–∏–π —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –î–∞–ª–µ–µ –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –Ω—É–∂–Ω–æ –Ω–∞–∂–∞—Ç—å –∏ —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É "+" –Ω–∞ —á–∞–π–Ω–∏–∫–µ –∏–ª–∏ "—Ç–∞–π–º–µ—Ä" –Ω–∞ –º—É–ª—å—Ç–∏–≤–∞—Ä–∫–µ  –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –≤–æ–π–¥–µ—Ç –≤ —Ä–µ–∂–∏–º –ø—Ä–∏–≤—è–∑–∫–∏ –∏ —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è —Å–æ–µ–¥–∏–Ω–∏—Ç—Å—è —Å–æ —à–ª—é–∑–æ–º.<br> 
&emsp; –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –æ–¥–Ω–æ–º—É MQTT —Å–µ—Ä–≤–µ—Ä—É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —à–ª—é–∑–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –≤ –∫–∞–∂–¥–æ–º —à–ª—é–∑–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π r4sGate Number. –®–ª—é–∑ —Å –Ω–æ–º–µ—Ä–æ–º 0 –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å –≤ —Ç–æ–ø–∏–∫ r4s/devaddr/..., —à–ª—é–∑ —Å –Ω–æ–º–µ—Ä–æ–º 1 - r4s1/devaddr/... –∏ —Ç.–¥. –ù—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ —É—á–µ—Å—Ç—å, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –ø—Ä–∏–≤—è–∑–∫–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–æ–º–µ—Ä–∞ —à–ª—é–∑–∞ –∏ –æ—Ç –Ω–æ–º–µ—Ä–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤ —à–ª—é–∑–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–≤—è–∑–∞—Ç—å 2 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —á–∞–π–Ω–∏–∫–∞ –∏–ª–∏ –º—É–ª—å—Ç–∏–≤–∞—Ä–∫–∏ –∫ 2 —Ä–∞–∑–Ω—ã–º —à–ª—é–∑–∞–º –∏–ª–∏ –∫ 2 —Ä–∞–∑–Ω—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–¥–Ω–æ–≥–æ —à–ª—é–∑–∞. –£ –º–µ–Ω—è —à–ª—é–∑ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ ioBroker. –ú–æ–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ MQTT –±—Ä–æ–∫–µ—Ä–∞ –Ω–∏–∂–µ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ 1.<br><br>
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mymqtt.jpg)
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 1. –ú–æ–∏ Mqtt –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.<br><br>
&emsp; –°–Ω—è—Ç —Ñ–ª–∞–≥ retain, —á—Ç–æ–±—ã –±—Ä–æ–∫–µ—Ä –Ω–µ –∑–∞–ø–æ–º–∏–Ω–∞–ª, –∞ —Å—á–∏—Ç—ã–≤–∞–ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø—Ä–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏. –í Home Assistant  —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –≤ –Ω–µ–º –∏/–∏–ª–∏ Mqtt –±—Ä–æ–∫–µ—Ä–µ —Ñ–ª–∞–≥ retain [–º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ —Å–∞–º–æ–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º—É –≤–∫–ª—é—á–µ–Ω–∏—é –∏ –≤—ã–∫–ª—é—á–µ–Ω–∏—é —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞](https://mjdm.ru/forum/viewtopic.php?f=8&t=5501&sid=de6b1e2b43f25c8d9ae9af5673ee9417&start=140#p121604). –î–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –∏ —É–ø—Ä–æ—â–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Home Assistant [–Ω–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ 2020.10.23 ](https://github.com/alutov/ESP32-R4sGate-for-Redmond/releases/tag/2020.10.23) –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ü–∏—é —à–ª—é–∑–∞ Hass Discovery. –ü–µ—Ä–µ–¥ –µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —É–¥–∞–ª–∏—Ç—å –≤ Mqtt –±—Ä–æ–∫–µ—Ä–µ –≤—Å–µ —Ç–æ–ø–∏–∫–∏ —Å r4s. –¢–∞–∫–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ñ–ª–∞–≥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ –≤–≤–æ–¥–∏—Ç—å –≤—Å–µ —Ç–æ–ø–∏–∫–∏ –≤—Ä—É—á–Ω—É—é. –ò–Ω–æ–≥–¥–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ä–∞–∑—É –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –ø–æ–¥–ø–∏—Å–æ–∫ ioBroker –ø–æ—á–µ–º—É-—Ç–æ –¥–µ–ª–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –∑–∞–ø–∏—Å–∏ :-), –µ—Å—Ç—å —É –º–µ–Ω—è —Ç–∞–∫–æ–π –≥–ª—é–∫. –ü—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∏—Ö —É–¥–∞–ª—è—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å Mqtt –∞–¥–∞–ø—Ç–µ—Ä, —á—Ç–æ–±—ã –æ–Ω–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –æ–ø—è—Ç—å.<br>
&emsp; Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è —á–∞–π–Ω–∏–∫–∞ (—Å–º. –∫–∞—Ä—Ç–∏–Ω–∫—É 2 –Ω–∏–∂–µ):<br>
r4s/devaddr/cmd/state <-- 0/off/false - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, 1/on/true - –∫–∏–ø—è—á–µ–Ω–∏–µ, 2...100 - –∫–∏–ø—è—á–µ–Ω–∏–µ –∏ –ø–æ–¥–æ–≥—Ä–µ–≤;<br>
r4s/devaddr/cmd/heat_temp <-- 0...39 - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, 40...90 –ø–æ–¥–æ–≥—Ä–µ–≤, > 90 - –∫–∏–ø—è—á–µ–Ω–∏–µ;<br>
r4s/devaddr/cmd/nightlight <-- 0/off/false - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ—á–Ω–∏–∫–∞, 1/on/true - –≤–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ—á–Ω–∏–∫–∞;<br>
r4s/devaddr/cmd/nightlight_red <- 0..255 –£—Ä–æ–≤–µ–Ω—å –∫—Ä–∞—Å–Ω–æ–≥–æ –≤ –Ω–æ—á–Ω–∏–∫–µ;<br>
r4s/devaddr/cmd/nightlight_green <- 0..255 –£—Ä–æ–≤–µ–Ω—å –∑–µ–ª–µ–Ω–æ–≥–æ –≤ –Ω–æ—á–Ω–∏–∫–µ;<br>
r4s/devaddr/cmd/nightlight_blue <- 0..255 –£—Ä–æ–≤–µ–Ω—å —Å–∏–Ω–µ–≥–æ –≤ –Ω–æ—á–Ω–∏–∫–µ;<br>
r4s/devaddr/rsp/ - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, rssi –∏ —Ç.–¥.;<br>
–ó–Ω–∞—á–µ–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –≤ —à–ª—é–∑–µ –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–∞ —á–∞–π–Ω–∏–∫ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –ø–æ–¥—Å–≤–µ—Ç–∫–∏.<br><br>
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mymqtt1.jpg)
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 2. –ú–æ–∏ Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è —á–∞–π–Ω–∏–∫–∞.<br><br> 
&emsp; Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è –º—É–ª—å—Ç–∏–≤–∞—Ä–∫–∏ (—Å–º. –∫–∞—Ä—Ç–∏–Ω–∫—É 3 –Ω–∏–∂–µ):<br>
r4s/devaddr/cmd/state <-- 0/off/false - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, 1/on/true - —Å—Ç–∞—Ä—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–ª–∏ –ø–æ–¥–æ–≥—Ä–µ–≤, –µ—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞;<br> 
r4s/devaddr/cmd/prog <-- –Ω–æ–º–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã 1-12, 0 - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ;<br>
 –ü—Ä–æ–≥—Ä–∞–º–º—ã:<br>
 1 - Rice / –†–∏—Å –ö—Ä—É–ø—ã, 2 - Slow Cooking / –¢–æ–º–ª–µ–Ω–∏–µ, 3 - Pilaf / –ü–ª–æ–≤, 4 - Frying / –ñ–∞—Ä–∫–∞;<br>
 5 - Stewing / –¢—É—à–µ–Ω–∏–µ, 6 - Pasta / –ü–∞—Å—Ç–∞, 7 - Milk Porridge / –ú–æ–ª–æ—á–Ω–∞—è –∫–∞—à–∞, 8 - Soup / –°—É–ø;<br>
 9 - Yogurt / –ô–æ–≥—É—Ä—Ç, 10 - Baking / –í—ã–ø–µ—á–∫–∞, 11 - Steam / –ü–∞—Ä, 12 - Hot / –í–∞—Ä–∫–∞ –ë–æ–±–æ–≤—ã–µ;<br>
r4s/devaddr/cmd/mode <-- —Ä–µ–∂–∏–º: 1 - –æ–≤–æ—â–∏, 2 - —Ä—ã–±–∞, 3 - –º—è—Å–æ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º 4,5,11<br>
r4s/devaddr/cmd/temp <-- —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞;<br>
r4s/devaddr/cmd/set_hour <-- –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã, —á–∞—Å—ã;<br>
r4s/devaddr/cmd/set_min <-- –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã, –º–∏–Ω—É—Ç—ã;<br>
r4s/devaddr/cmd/delay_hour <-- –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–ª—é—Å –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã, —á–∞—Å—ã;<br>
r4s/devaddr/cmd/delay_min <-- –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–ª—é—Å –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –º–∏–Ω—É—Ç—ã;<br>
r4s/devaddr/cmd/warm <-- –ø–æ–¥–æ–≥—Ä–µ–≤ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã;<br>
&emsp; –ü–∞—Ä–∞–º–µ—Ç—Ä—ã delay_hour –∏ delay_min –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –≤ —à–ª—é–∑–µ –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Ä–µ–∂–∏–º–∞ –∏–ª–∏ –ø–æ–¥–æ–≥—Ä–µ–≤–∞, –∞ –ø–æ—Ç–æ–º—É —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Ä–µ–∂–∏–º–∞ –∏–ª–∏ –∞–≤—Ç–æ–ø–æ–¥–æ–≥—Ä–µ–≤–∞. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ mode –µ—â–µ —Ä–∞–∑ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è. –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ —Ä–µ–∂–∏–º–∞ –º–æ–∂–Ω–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É. –≠—Ç–æ—Ç –ø–æ—Ä—è–¥–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω —Ç–µ–º, —á—Ç–æ –ø–æ Mqtt –Ω–µ–ª—å–∑—è —Å—Ä–∞–∑—É —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Ç–æ–ø–∏–∫–∞—Ö. –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∂–µ —á–µ—Ä–µ–∑ web –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–∞–≤—è—Ç—Å—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π. –ò –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ —Ä–µ–∂–∏–º–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ web —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–µ—Ä–µ–¥ —ç—Ç–∏–º –æ–Ω–∏ –±—ã–ª–∏  —Ä–∞–≤–Ω—ã 0. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –º—É–ª—å—Ç–∏–ø–æ–≤–∞—Ä –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è, —è –Ω–µ –≤–∏–∂—É —Å–º—ã—Å–ª–∞. –ü—Ä–∏ –∑–∞–ø–∏—Å–∏ –Ω—É–ª—è –≤ prog –Ω–∞ –º—É–ª—å—Ç–∏–≤–∞—Ä–∫—É –ø–æ—Å—ã–ª–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏—è, —á—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br><br>
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mymqtt2.jpg)
 –ö–∞—Ä—Ç–∏–Ω–∫–∞ 3. –ú–æ–∏ Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è –º—É–ª—å—Ç–∏–≤–∞—Ä–∫–∏.<br><br> 
&emsp; Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è –∫–æ—Ñ–µ–≤–∞—Ä–∫–∏:<br>
r4s/devaddr/cmd/state <-- 0/off/false - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, 1/on/true - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
r4s/devaddr/cmd/delay_hour <-- –≤—Ä–µ–º—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞, —á–∞—Å—ã;<br>
r4s/devaddr/cmd/delay_min <-- –≤—Ä–µ–º—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞, –º–∏–Ω—É—Ç—ã;<br>
r4s/devaddr/cmd/delay <-- –∑–∞–ø—É—Å–∫ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞, 0/off/false - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, 1/on/true - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
r4s/devaddr/cmd/lock <-- –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, 0/off/false - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, 1/on/true - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
r4s/devaddr/cmd/strength <-- –∫—Ä–µ–ø–æ—Å—Ç—å, 0/off/false - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, 1/on/true - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
r4s/devaddr/rsp/ - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, rssi –∏ —Ç.–¥.;<br>
–ó–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –≤ —à–ª—é–∑–µ –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–∞ –∫–æ—Ñ–µ–≤–∞—Ä–∫—É –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —ç—Ç–æ–≥–æ —Ä–µ–∂–∏–º–∞.<br><br>
&emsp; Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è —Ä–æ–∑–µ—Ç–∫–∏:<br>
r4s/devaddr/cmd/state <-- 0/off/false - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, 1/on/true - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
r4s/devaddr/cmd/lock <-- –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, 0/off/false - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, 1/on/true - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
r4s/devaddr/rsp/ - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, rssi –∏ —Ç.–¥.;<br><br>
&emsp; [–ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ 2020.10.27 ](https://github.com/alutov/ESP32-R4sGate-for-Redmond/releases/tag/2020.10.27) –ø–æ—è–≤–∏–ª–∞—Å—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤–º–µ—â–µ–Ω–Ω—ã–µ —Ç–æ–ø–∏–∫–∏ –¥–ª—è –∫–æ–º–∞–Ω–¥ –∏ –æ—Ç–≤–µ—Ç–æ–≤. –û–ø—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –ú–Ω–µ —ç—Ç–æ –ø—Ä–∏–≥–æ–¥–∏–ª–æ—Å—å –ø—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ Google Home —Å –ø–æ–º–æ—â—å—é –¥—Ä–∞–π–≤–µ—Ä–∞ iot iobroker-–∞. –ö–∞–∫ —è –ø–æ–Ω—è–ª, —ç—Ç–æ—Ç –¥—Ä–∞–π–≤–µ—Ä –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–∞–∑–¥–µ–ª—å–Ω—ã–µ —Ç–æ–ø–∏–∫–∏ –∫–æ–º–∞–Ω–¥/–æ—Ç–≤–µ—Ç–æ–≤. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ç–∞–∫ –∫–∞–∫ Google Home –ø–æ–Ω–∏–º–∞–µ—Ç "true / false" –≤–º–µ—Å—Ç–æ "ON / OFF", —Ç–æ –Ω—É–∂–Ω–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –¥—Ä–∞–π–≤–µ—Ä–∞ iot "Conversation to Google Home = function (value) {}" –≤–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫—É –≤–∏–¥–∞ "switch (value) {case "ON": return true ; break; default: return false;} ". –ï—Å–ª–∏ –∂–µ –∞–≤—Ç–æ–∑–∞–º–µ–Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, —Ç–æ [–Ω–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ 2020.11.07 ](https://github.com/alutov/ESP32-R4sGate-for-Redmond/releases/tag/2020.11.07) –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ü–∏—é ""true / false" Response". –û–ø—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å Hass Discovery, —Ç–∞–º –æ–Ω–∞ –Ω–µ –Ω—É–∂–Ω–∞.<br>
&emsp; –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ç–∞–∫–∂–µ –∏ –≤ –≤–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —à–ª—é–∑–∞. –ü—Ä–∏–º–µ—Ä—ã –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∏–∂–µ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞—Ö 4 –∏ 5.

**–í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—á–∫–∞**:
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/myweb.jpg) 
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 4. –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—á–∫–∞.<br><br>
**–í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —Å—Ç—Ä–∞–Ω–∏—á–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫**:
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/myweb1.jpg) 
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 5. –°—Ç—Ä–∞–Ω–∏—á–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫.<br><br>
 
#### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —ç–∫—Ä–∞–Ω–∞<br>
&emsp; –í –ø–µ—Ä–≤–æ–π –≤–µ—Ä—Å–∏–∏ —à–ª—é–∑–∞ –æ—Å—Ç–∞–≤–∞–ª—Å—è –∑–∞–ø–∞—Å –∫–∞–∫ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π (~100–∫–ë–∞–π—Ç), —Ç–∞–∫ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä—É–µ–º–æ–π (~400–∫–ë–∞–π—Ç) —Å–≤–æ–±–æ–¥–Ω–æ–π –ø–∞–º—è—Ç–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–ª–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ—à–∏–≤–∫–∏, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —ç–∫—Ä–∞–Ω–∞. –ö —Ç–æ–º—É –∂–µ —É –º–µ–Ω—è —É–∂–µ –±—ã–ª–∞ —Å–æ–±—Ä–∞–Ω–Ω–∞—è esp32 —Å —ç–∫—Ä–∞–Ω–æ–º [3.2" 320x240 –Ω–∞ —á–∏–ø–µ ili9341](https://www.aliexpress.com/item/32911859963.html?spm=a2g0s.9042311.0.0.274233edzZnjSp), —Ä–∞–±–æ—Ç–∞—é—â–∞—è —Å –ø—Ä–æ—à–∏–≤–∫–æ–π —Å —Å–∞–π—Ç–∞ [wifi-iot](https://wifi-iot.com/). –í–æ–∑–º–æ–∂–Ω–æ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è —à–ª—é–∑–∞ —É–∂–µ –≥–æ—Ç–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ —á–∏–ø–µ ili9341, –Ω–∞–ø—Ä–∏–º–µ—Ä [TFT BTC Ticker](https://aliexpress.ru/item/1005001358148811.html?spm=a2g0o.productlist.0.0.451e6dbe9z6WOU&algo_pvid=775d439e-9930-454b-91cf-e1f5c1404bf2&algo_expid=775d439e-9930-454b-91cf-e1f5c1404bf2-4&btsid=0b8b036316061501449102110e230e&ws_ab_test=searchweb0_0,searchweb201602_,searchweb201603_) –∏–ª–∏ [m5 stack basic](https://m5stack.com/products/basic-core-iot-development-kit). –í —à–ª—é–∑–µ —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏–∑ [Bodmer](https://github.com/Bodmer/TFT_eSPI), –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–≤—Å–µ–º —Ö–æ—Ä–æ—à–æ, –Ω–æ –∫–∞–∫ –µ—Å—Ç—å –¥–ª—è esp-iot. –ü–∏–Ω—ã –¥–ª—è –ø–æ–∫–ª—é—á–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: MOSI-23, MISO-25, CLK-19, CS-16, DC-17, RST-18, BACKLIGHT-21. TOUCH CS –ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ 33 –ø–∏–Ω—É, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å. –ü–∏–Ω—ã –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –ï—Å—Ç—å —Ç–∞–∫–∂–µ –æ–ø—Ü–∏—è –ø–æ–≤–æ—Ä–æ—Ç–∞ —ç–∫—Ä–∞–Ω–∞ –Ω–∞ 180&deg;, –∞ —Ç–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∫–ª—é—á–µ–Ω–∏—è –∏ –≤—ã–∫–ª—é—á–µ–Ω–∏—è –¥–∏—Å–ø–ª–µ—è –ø–æ Mqtt, –∏c–ø–æ–ª—å–∑—É—è —Ç–æ–ø–∏–∫ r4s/screen. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —ç–∫—Ä–∞–Ω–∞ –Ω–∞ —à–∏–Ω–µ SPI –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ. –ü–æ–ª—É—á–∏–ª–æ—Å—å —á—Ç–æ-—Ç–æ –ø–æ—Ö–æ–∂–µ–µ –Ω–∞ —á–∞—Å—ã. –ù–∞ —ç–∫—Ä–∞–Ω –≤—ã–≤–æ–¥–∏—Ç—Å—è —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è, –¥–µ–Ω—å –∏ –º–µ—Å—è—Ü, –∞ —Ç–∞–∫–∂–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å –≤ –¥–æ–º–µ, —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—Å–∏–Ω–∏–π- –≤—ã–∫–ª., –∫—Ä–∞—Å–Ω—ã–π - –≤–∫–ª.) –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ –∫–æ—Ç–ª–∞, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å –Ω–∞ —É–ª–∏—Ü–µ. –í—Å–µ –±–µ—Ä–µ—Ç—Å—è —Å Mqtt. –¢–∞–∫–∂–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö Ble —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –ü—Ä–∏–º–µ—Ä —ç–∫—Ä–∞–Ω–∞ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ 6.<br><br>
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft.jpg)
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 6. –≠–∫—Ä–∞–Ω —à–ª—é–∑–∞ 1.<br><br>
&emsp; –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ –Ω–∞ —ç–∫—Ä–∞–Ω –∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ jpeg 320x176. –†–∞–∑–º–µ—Ä –∫–∞—Ä—Ç–∏–Ω–∫–∏ –±—É–¥–µ—Ç –æ–∫–æ–ª–æ 20 –∫–ë–∞–π—Ç. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å url –∫–∞—Ä—Ç–∏–Ω–∫–∏. –£ –º–æ–µ–π –∫–∞–º–µ—Ä—ã url —Ç–∞–∫–æ–π: http://192.168.1.7/auto.jpg?usr=admin&pwd=admin. –ö–∞—Ä—Ç–∏–Ω–∫–∞ –≥—Ä—É–∑–∏—Ç—Å—è –≤ –±—É—Ñ–µ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 32768 –±–∞–π—Ç –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –ü—Ä–∏–º–µ—Ä —ç–∫—Ä–∞–Ω–∞ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ 7. <br><br>
 ![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft3.jpg)
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 7. –≠–∫—Ä–∞–Ω —à–ª—é–∑–∞ 2.<br><br>

&emsp; –°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å–∞–º–∞ TFT –ø–ª–∞—Ç–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∫ WiFi, —Ç–∞–∫ –∏ BLE. –ò –¥–∞–∂–µ –µ—Å–ª–∏ –∞–Ω—Ç–µ–Ω–Ω–∞ esp32 –≤—ã–≥–ª—è–¥—ã–≤–∞–µ—Ç –∏–∑-–ø–æ–¥ —ç–∫—Ä–∞–Ω–∞, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—å —Ç–∞–∫–æ–≥–æ "–±—É—Ç–µ—Ä–±—Ä–æ–¥–∞" –∑–∞–º–µ—Ç–Ω–æ –º–µ–Ω—å—à–µ –æ–±—ã—á–Ω–æ–π esp32. –†–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å —ç–∫—Ä–∞–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç esp32 —Å –≤–Ω–µ—à–Ω–µ–π –∞–Ω—Ç–µ–Ω–Ω–æ–π. –£ –º–µ–Ω—è –≤ —à–ª—é–∑–µ —Å —ç–∫—Ä–∞–Ω–æ–º –∑–∞–º–µ–Ω–∞ esp32 –Ω–∞ –≤–∞—Ä–∏–∞–Ω—Ç —Å —Ä–∞–∑—ä–µ–º–æ–º –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–Ω–µ—à–Ω–µ–π –∞–Ω—Ç–µ–Ω–Ω—ã –¥–∞–ª–∞ –ø—Ä–∏—Ä–æ—Å—Ç —É—Ä–æ–≤–Ω–µ–π WIFI –∏ BLE –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 15-20dBm.<br>
&emsp; –ï—Å–ª–∏ –∂–µ —ç–∫—Ä–∞–Ω –Ω–µ –Ω—É–∂–µ–Ω, —Ç–æ –Ω—É–∂–Ω–æ –ø–æ—Å–ª–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏  esp32 –ø–æ–¥—Å–æ–µ–¥–∏–Ω–∏—Ç—å –µ–µ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫—É –ø–∏—Ç–∞–Ω–∏—è –∏ —Å–ø—Ä—è—Ç–∞—Ç—å –≥–¥–µ-–Ω–∏–±—É–¥—å –Ω–∞ –∫—É—Ö–Ω–µ.<br>
# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
&emsp; –î–ª—è —Å–±–æ—Ä–∫–∏ –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω [Espressif IoT Development Framework.](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/)<br>
